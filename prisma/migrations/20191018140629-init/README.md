# Migration `20191018140629-init`

This migration has been generated by Johnni Mortensen at 10/18/2019, 2:06:29 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "lift"."User" (
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "email" TEXT NOT NULL DEFAULT ''  ,
  "id" TEXT NOT NULL   ,
  "name" TEXT NOT NULL DEFAULT ''  ,
  "password" TEXT NOT NULL DEFAULT ''  ,
  "playercode" TEXT NOT NULL DEFAULT ''  ,
  "team" TEXT    REFERENCES "Team"(id) ON DELETE SET NULL,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."Team" (
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "id" TEXT NOT NULL   ,
  "name" TEXT NOT NULL DEFAULT ''  ,
  "owner" TEXT    REFERENCES "User"(id) ON DELETE SET NULL,
  "points" INTEGER NOT NULL DEFAULT 1000  ,
  "shortname" TEXT NOT NULL DEFAULT ''  ,
  "teamcode" TEXT NOT NULL DEFAULT ''  ,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."TeamInvitation" (
  "id" TEXT NOT NULL   ,
  "player" TEXT    REFERENCES "User"(id) ON DELETE SET NULL,
  "team" TEXT    REFERENCES "Team"(id) ON DELETE SET NULL,
  PRIMARY KEY ("id")
);

CREATE UNIQUE INDEX "lift"."User.id" ON "User"("id")

CREATE UNIQUE INDEX "lift"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "lift"."User.playercode" ON "User"("playercode")

CREATE UNIQUE INDEX "lift"."Team.id" ON "Team"("id")

CREATE UNIQUE INDEX "lift"."Team.teamcode" ON "Team"("teamcode")

CREATE UNIQUE INDEX "lift"."TeamInvitation.id" ON "TeamInvitation"("id")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20191018140629-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,41 @@
+generator photon {
+  provider = "photonjs"
+}
+
+datasource db {
+  provider = "sqlite"
+  url      = "file:dev.db"
+}
+
+model User {
+    id         String   @default(cuid()) @id @unique
+    name       String
+    email      String   @unique
+    playercode String   @unique
+    password   String
+    updatedAt  DateTime @updatedAt
+    createdAt  DateTime @default(now())
+    ownTeam    Team? @relation(name: "TeamToOwner", onDelete: CASCADE)
+    team       Team? @relation(name: "TeamToPlayer")
+    teamInvitations TeamInvitation[]
+}
+
+
+model Team {
+    id        String   @default(cuid()) @id @unique
+    name      String
+    shortname String
+    teamcode  String   @unique
+    updatedAt DateTime @updatedAt
+    createdAt DateTime @default(now())
+    points    Int      @default(value: 1000)
+    owner     User     @relation(references: [id], name: "TeamToOwner")
+    players   User[]   @relation(references: [id], name: "TeamToPlayer")
+    playerInvitations TeamInvitation[]
+}
+
+model TeamInvitation {
+    id  String @default(cuid()) @id @unique
+    player User
+    team Team
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20191018140629-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20191018140629-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
